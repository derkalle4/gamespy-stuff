Gamespy Nat Negotation Protocol

PCAP dump summary:

-> Server select

RESOLV natneg1.gamespy.com    => 69.10.30.254
RESOLV natneg2.gamespy.com    => 69.10.30.253

MASTER SERVER COOKIE REQ-->
--------------------------------------------------------------------------------
localhost@tcpd -> 69.10.30.247 
00:13:02:50:79:1f:c0:0e:4a
000:019:002:080:121:031:192:014:074:
          P   y      ?      J 
|-----------|dip-----------|dport--|


--------------------------------------------------------------------------------


NATNEG REQ-->
--------------------------------------------------------------------------------
                                               +0
UDP localhost@3658 -> 69.10.30.254@27901
fd:fc:1e:66:6a:b2:02:00:00:00:2c:e6:00:01:01:c0:a8:b2:23:00:00:73:77:62:66:72:6f:6e:74:32:70:63:00
253:252:030:102:106:178:002:000:000:000:044:230:000:001:001:192:168:178:035:000:000:115:119:098:102:114:111:110:116:050:112:099:000
?   ?      f   j   ?                  ,   ?             ?   ?   ?   #           s   w   b   f   r   o   n   t   2   p   c        
|--------------------------|            |------|    |------|localip-------|         |gamename----------------------------------| 
 Cookie^                              GSID?^

                                                +2            
UDP localhost@rand -> 69.10.30.254@27901
fd:fc:1e:66:6a:b2:02:00:00:00:2c:e6:01:01:01:c0:a8:b2:23:00:00:73:77:62:66:72:6f:6e:74:32:70:63:00
253:252:030:102:106:178:002:000:000:000:044:230:001:001:001:192:168:178:035:000:000:115:119:098:102:114:111:110:116:050:112:099:000:
?   ?      f   j   ?                  ,   ?            ?   ?   ?   #           s   w   b   f   r   o   n   t   2   p   c       
|--------------------------|            |------|    |------|localip-------|         |gamename----------------------------------|
 Cookie^
                                                +2
UDP localhost@3658 -> 69.10.30.253@27901
fd:fc:1e:66:6a:b2:02:00:00:00:2c:e6:02:01:01:c0:a8:b2:23:0e:4b:73:77:62:66:72:6f:6e:74:32:70:63:00
253:252:030:102:106:178:002:000:000:000:044:230:002:001:001:192:168:178:035:014:075:115:119:098:102:114:111:110:116:050:112:099:000:
?   ?      f   j   ?                  ,   ?            ?   ?   ?   #      K   s   w   b   f   r   o   n   t   2   p   c       
|--------------------------|            |------|    |------|localip-------|---------|gamename----------------------------------|
 Cookie^                                                            Port [3659]^

--------------------------------------------------------------------------------

MASTER SERVER COOKIE RES-->
--------------------------------------------------------------------------------
69.10.30.247 -> localhost@tcpd 
fd:fc:1e:66:6a:b2:00:00:2c:e6
253:252:030:102:106:178:000:000:044:230
?   ?      f   j   ?           ,   ?  
|----------------------|        |------|
 Cookie^   
--------------------------------------------------------------------------------

NATNEG RES--> 
--------------------------------------------------------------------------------
                                                +0
UDP 69.10.30.254@27901 -> localhost@3658
fd:fc:1e:66:6a:b2:02:01:00:00:2c:e6:00:01:ff:ff:6d:16:b5:7d:ea
253:252:030:102:106:178:002:001:000:000:044:230:000:001:255:255:109:022:181:125:234:
?   ?      f   j   ?                 ,   ?          ?   ?   m      ?   }   ?   
|-------------------------|             |------|
 Cookie^  
                                                +2
UDP 69.10.30.253@27901 -> localhost@rand
fd:fc:1e:66:6a:b2:02:01:00:00:2c:e6:02:01:ff:ff:6d:16:b5:7d:ea
253:252:030:102:106:178:002:001:000:000:044:230:002:001:255:255:109:022:181:125:234:
?   ?      f   j   ?                 ,   ?         ?   ?   m      ?   }   ?   
|-------------------------|             |------|
 Cookie^  

                                                +1
UDP 69.10.30.254@27901 -> localhost@rand
fd:fc:1e:66:6a:b2:02:01:00:00:2c:e6:01:01:ff:ff:6d:16:b5:7d:ea
253:252:030:102:106:178:002:001:000:000:044:230:001:001:255:255:109:022:181:125:234:
?   ?      f   j   ?                 ,   ?         ?   ?   m      ?   }   ?   
|-------------------------|             |------|
 Cookie^ 
                                                +1
 
UDP 69.10.30.254@27901 -> localhost@rand
fd:fc:1e:66:6a:b2:02:01:00:00:2c:e6:01:01:ff:ff:6d:16:b5:7d:ea
253:252:030:102:106:178:002:001:000:000:044:230:001:001:255:255:109:022:181:125:234:
?   ?      f   j   ?                 ,   ?         ?   ?   m      ?   }   ?   
|-------------------------|             |------|
 Cookie^ 
 
                            +5
UDP 69.10.30.254@27901 -> localhost@rand
fd:fc:1e:66:6a:b2:02:05:00:00:2c:e6:50:79:1f:c0:0e:4a:42:00
253:252:030:102:106:178:002:005:000:000:044:230:080:121:031:192:014:074:066:000:
?   ?      f   j   ?                 ,   ?   P   y      ?      J   B       
|-------------------------|             |------|remoteip---|dport--|
 Cookie^ 
                            +6
UDP localhost@rand -> 69.10.30.254@27901
fd:fc:1e:66:6a:b2:02:06:00:00:2c:e6:fc:01:00:00:58:f9:3e:02:01
253:252:030:102:106:178:002:006:000:000:044:230:252:001:000:000:088:249:062:002:001:
?   ?      f   j   ?                 ,   ?   ?              X   ?   >         
|--------------------------|
 Cookie^ 
--------------------------------------------------------------------------------

DIRECT-CONNECT-->
--------------------------------------------------------------------------------
GS Connnect

localhost@3658 -> gs@3658
fd:fc:1e:66:6a:b2:02:07:00:00:2c:e6:50:79:1f:c0:0e:4a:00:00

gs@3658 -> localhost@3658
fd:fc:1e:66:6a:b2:02:07:00:00:2c:e6:54:76:7a:1d:0e:4b:01:01

...

--------------------------------------------------------------------------------